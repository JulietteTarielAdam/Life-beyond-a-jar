---
title: "Dropped analysis"
date: "`r Sys.Date()`"
format: 
   html:
    embed-resources: true
    self-contained-math: true
editor_options: 
  chunk_output_type: console
knitr:
  opts_chunk:
    fig-align: center
    out-width: "100%"
---

```{r}
#| include: false
source("Script/Load-data.R")
source("Script/Functions/Plots.R")
source("Script/Functions/Linear-model.R")
```




 
# Sinking/Floating

Sinking/Floating contributed almost nothing to the first three PCA components (2%) + did not correlate strongly with any of the component. Sinking/Floating was not important to explain the variability between trials. After discussion with Naomi and Culum, we agree to not analyse this behavioural type.

I still present the linear model on Sinking/Floating below.

 
::: {.panel-tabset}

 
## Distribution 

```{r}
hist1(data$Sinking.Floating)
table(data$Sinking.Floating==0)
```

Many zeros, analysis with a binary generalised linear model. 

 
## Plot 

```{r}
#| warning: false
plot_var_binary(data, "SF.bin")
plot_var_binary(data, "SF.bin") + facet_wrap(~Fish)
```

## Generalised linear model 

```{r}
#| column: page
mSF <- glmmTMB(SF.bin ~ Tank + Time + Filter + (1|Fish), data = data, family =binomial)
Anova(mSF)
calc_contrasts_bin(mSF)
```

Effect of Tank. 

+ Tank. Problem with the calculation of contrast because fish never sinked or floated in Large. Solution 1: don't include this behavioural type at all in the analysis as it has very little influence based on the PCA. Solution 2: include it anyway and state that the calculation of contrasts and corresponding tests were not possible. Just intepret it qualitatively with no test (Fish were more likely to perform sinking/floating in Jar, then Small and Medium were pretty similar, then Large. Fish in Barren were more likely to perform Sinking/Floating than fish in Large).

## Diagnosis 

```{r}
mSF_res <- simulateResiduals(mSF)
plot(mSF_res)
plotResiduals(mSF_res, form = data$Tank)
plotResiduals(mSF_res, form = data$Time)
plotResiduals(mSF_res, form = data$Filter)
```

The model seems good.

:::

